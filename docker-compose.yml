services:
  ioq3-ded:
    container_name: "ioq3-ded"
    restart: "unless-stopped"

    # Build settings for the Quake 3 dedicated server image
    build:
      context: .
      dockerfile: Dockerfile

    # Enable interactive console access:
    #   docker attach ioq3-ded
    stdin_open: true
    tty: true

    # Run server as non-root user (UID:GID = 1000:1000)
    user: "1000:1000"

    # Expose Quake 3 server port (UDP)
    ports:
      - "27960:27960/udp"

    # Persistent game data (configs, maps, pk3 files, etc.)
    volumes:
      - ./baseq3:/home/ioq3srv/.config/Quake3/baseq3

    # Server command:
    #  - dedicated 2 = pure dedicated server
    #  - Enable downloads
    #  - Increase memory
    #  - Start on q3dm17
    command: >
      +set dedicated 2
      +set sv_allowDownload 1
      +set com_hunkmegs 64
      +map q3dm17

    # Environment variables
    environment:
      TZ: "Europe/Berlin"
      sv_hostname: "My Quake Server"
